<!doctype html><html lang=vi class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.101.0"><meta name=description content><meta name=author content="journeyoftheaverageguy@gmail.com"><link rel=icon href=https://hotloncon1.github.io/aws-lab000052/images/favicon.png type=image/png><title>Triển khai hàm Lambda ImageManager :: Cấu hình tự động phát hành ứng dụng</title><link href=https://hotloncon1.github.io/aws-lab000052/css/nucleus.css?1660055407 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000052/css/fontawesome-all.min.css?1660055407 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000052/css/hybrid.css?1660055407 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000052/css/featherlight.min.css?1660055407 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000052/css/perfect-scrollbar.min.css?1660055407 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000052/css/auto-complete.css?1660055407 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000052/css/atom-one-dark-reasonable.css?1660055407 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000052/css/theme.css?1660055407 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000052/css/hugo-theme.css?1660055407 rel=stylesheet><link href=https://hotloncon1.github.io/aws-lab000052/css/theme-workshop.css?1660055407 rel=stylesheet><script src=https://hotloncon1.github.io/aws-lab000052/js/jquery-3.3.1.min.js?1660055407></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=https://hotloncon1.github.io/aws-lab000052/vi/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://hotloncon1.github.io/aws-lab000052/><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=https://hotloncon1.github.io/aws-lab000052/js/lunr.min.js?1660055407></script>
<script type=text/javascript src=https://hotloncon1.github.io/aws-lab000052/js/auto-complete.js?1660055407></script>
<script type=text/javascript>var baseurl="https://hotloncon1.github.io/aws-lab000052//vi"</script><script type=text/javascript src=https://hotloncon1.github.io/aws-lab000052/js/search.js?1660055407></script></div><div class=highlightable><ul class=topics><li data-nav-id=/vi/1-introduction/ title="Giới thiệu" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/1-introduction/><b>1. </b>Giới thiệu
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/2-prepare/ title="Chuẩn bị" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/2-prepare/><b>2. </b>Chuẩn bị
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/2-prepare/2.1-createkeypair/ title="Tạo Key Pair" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/2-prepare/2.1-createkeypair/><b>2.1. </b>Tạo Key Pair
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/2-prepare/2.2-createstack/ title="Tạo CloudFormation stack" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/2-prepare/2.2-createstack/><b>2.2. </b>Tạo CloudFormation stack
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/2-prepare/2.3-connectvirtualmachine/ title="Kết nối Windows instance" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/2-prepare/2.3-connectvirtualmachine/><b>2.3. </b>Kết nối Windows instance
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/2-prepare/2.4-setups3/ title="Cài đặt S3 buckets" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/2-prepare/2.4-setups3/><b>2.4. </b>Cài đặt S3 buckets
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/3-create-serverless-microservices/ title="Tạo một microservice" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/3-create-serverless-microservices/><b>3. </b>Tạo một microservice
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/3-create-serverless-microservices/3.1-create-lambda-function/ title="Tạo và kiểm tra hàm Lambda tại cục bộ" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/3-create-serverless-microservices/3.1-create-lambda-function/><b>3.1. </b>Tạo và kiểm tra hàm Lambda tại cục bộ
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-create-serverless-microservices/3.2-update-and-test/ title="Tải lên và kiểm tra hàm Lambda trong AWS Lambda " class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/3-create-serverless-microservices/3.2-update-and-test/><b>3.2. </b>Tải lên và kiểm tra hàm Lambda trong AWS Lambda
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/4-extending-serverless-microservices/ title="Mở rộng Serverless Microservices" class="dd-item
parent"><a href=https://hotloncon1.github.io/aws-lab000052/vi/4-extending-serverless-microservices/><b>4. </b>Mở rộng Serverless Microservices
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/ title="Triển khai hàm Lambda ImageManager " class="dd-item
active"><a href=https://hotloncon1.github.io/aws-lab000052/vi/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/><b>4.1. </b>Triển khai hàm Lambda ImageManager
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-extending-serverless-microservices/4.2-automating-your-microservice/ title="Tự động hóa Serverless Microservice" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/4-extending-serverless-microservices/4.2-automating-your-microservice/><b>4.2. </b>Tự động hóa Serverless Microservice
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-extending-serverless-microservices/4.3-update-lambda-function/ title="(Optional) Cập nhật quyền của hàm Lambda " class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/4-extending-serverless-microservices/4.3-update-lambda-function/><b>4.3. </b>(Optional) Cập nhật quyền của hàm Lambda
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-use-codestar-orchestration/ title="Cấu hình điều phối với CodeStar" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/5-use-codestar-orchestration/><b>5. </b>Cấu hình điều phối với CodeStar
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-use-codestar-orchestration/5.1-create-new-branch/ title="Tạo nhánh mới" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/5-use-codestar-orchestration/5.1-create-new-branch/><b>5.1. </b>Tạo nhánh mới
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-use-codestar-orchestration/5.2-redeploy-through-cicd-pipeline/ title="Triển khai lại thông qua CI/CD pipeline " class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/5-use-codestar-orchestration/5.2-redeploy-through-cicd-pipeline/><b>5.2. </b>Triển khai lại thông qua CI/CD pipeline
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-use-codestar-orchestration/5.3-update-target-region/ title="Cập nhật target region cho API " class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/5-use-codestar-orchestration/5.3-update-target-region/><b>5.3. </b>Cập nhật target region cho API
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/6-challenge/ title="Thử thách - Expose microservice API" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/6-challenge/><b>6. </b>Thử thách - Expose microservice API
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/7-cleanup/ title="Dọn dẹp tài nguyên" class=dd-item><a href=https://hotloncon1.github.io/aws-lab000052/vi/7-cleanup/><b>7. </b>Dọn dẹp tài nguyên
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=http://awsstudygroup.com><i class='fab fa-aws'></i> AWS Study Group - Blog</a></li><li><a class=padding href=https://www.facebook.com/groups/660548818043427/><i class='fab fa-facebook'></i> AWS Study Group - Nhóm FB</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://hotloncon1.github.io/aws-lab000052/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/>English</option><option id=vi value=https://hotloncon1.github.io/aws-lab000052/vi/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/ selected>Tiếng Việt</option></select><svg id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7833031&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0></left>
<left><br><br><b>Last Updated</b><br><i><font color=orange>09-08-2022</font></i></left>
<left><br><br><b>Team</b><br><i><a href=https://www.linkedin.com/in/jotaguy style=color:orange>Gia Hưng</a></i></left>
<script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=https://hotloncon1.github.io/aws-lab000052/vi/>Tạo một Microservice</a> > <a href=https://hotloncon1.github.io/aws-lab000052/vi/4-extending-serverless-microservices/>Mở rộng Serverless Microservices</a> > Triển khai hàm Lambda ImageManager</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Triển khai hàm Lambda ImageManager</h1><h4 id=triển-khai-hàm-lambda-imagemanager>Triển khai hàm Lambda ImageManager</h4><p>Bạn sẽ chỉnh sửa đoạn code trong <strong>handleRequest</strong> trong tập tin <strong>LambdaFunctionHandler.java</strong> để những tập tin có contentType không phải là <strong>image/jpeg</strong> sẽ bị xóa bởi hàm Lambda. Điều này mô phỏng một tình huống, trong đó nếu có một tập tin tải lên sai content type, tập tin này sẽ bị loại bỏ và không xử lý. Nếu tập tin đó là <strong>image/jpeg</strong>, hàm Lambda sẽ thu nhỏ hình ảnh và chuyển hình thu nhỏ tới một target bucket để ứng dụng có thể sử dụng chúng.</p><ol><li>Mở file <strong>LambdaFunctionHandler.java</strong> có đường dẫn <strong>src/main/java/idevelop.lambda.s3handler/LambdaFunctionHandler.java</strong></li></ol><ul><li>Tìm dòng code dưới đây</li></ul><pre tabindex=0><code>context.getLogger().log(&#34;CONTENT TYPE: &#34; + contentType);
</code></pre><ul><li>Sau dòng code trên, thêm đoạn code sau để gọi 2 xử lý - một cho tập tin hình ảnh và một cho các tập tin không phải hình ảnh</li></ul><pre tabindex=0><code>switch ( contentType )
{
	case &#34;application/x-directory&#34;:
		System.out.println(&#34;application/x-directory detected - ignoring&#34;);
		break;

	case &#34;image/jpeg&#34;:

		System.out.println(&#34;image/jpeg detected&#34;);
		InputStream objectData = null;
		objectData = response.getObjectContent();
		handleJPEG(bucket, key, objectData);
		break;

	default:
		handleAllOtherContentTypes(bucket, key);
		break;
}
</code></pre><p><img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-001.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function">
2. Thêm đoạn code dưới đây vào cuối của class <strong>LambdaFunctionHandler</strong></p><pre tabindex=0><code>private void handleJPEG(String bucketName, String key, InputStream imageStream) {

	final int THUMBNAIL_WIDTH = 100;
	final int THUMBNAIL_HEIGHT= 100;

	try
	{
		System.out.println(&#34;Starting resize process...&#34;);

		System.out.println(String.format(
				&#34;Starting resize process for %s/%s of type image/jpg&#34;, bucketName, key));

		// Resize the image
		System.out.println(&#34;     Reading image stream from S3&#34;);
		BufferedImage image = ImageIO.read(imageStream);
		System.out.println(&#34;          done&#34;);

		final BufferedImage thumbnailImage = new BufferedImage(THUMBNAIL_WIDTH, THUMBNAIL_HEIGHT, BufferedImage.TYPE_INT_RGB);
		final Graphics2D graphics2D = thumbnailImage.createGraphics();
		graphics2D.setComposite(AlphaComposite.Src);

		graphics2D.setRenderingHint(RenderingHints.KEY_INTERPOLATION,RenderingHints.VALUE_INTERPOLATION_BILINEAR);
		graphics2D.setRenderingHint(RenderingHints.KEY_RENDERING,RenderingHints.VALUE_RENDER_QUALITY);
		graphics2D.setRenderingHint(RenderingHints.KEY_ANTIALIASING,RenderingHints.VALUE_ANTIALIAS_ON);

		System.out.println(&#34;     Drawing image...&#34;);
		graphics2D.drawImage(image, 0, 0, THUMBNAIL_WIDTH, THUMBNAIL_HEIGHT, null);
		System.out.println(&#34;          done&#34;);
		graphics2D.dispose();

		System.out.println(&#34;     Opening output file...&#34;);
		File fileThumbnail = new File(&#34;/tmp/thumbnail.jpg&#34;);
		System.out.println(&#34;          done&#34;);
		System.out.println(&#34;     Writing output file...&#34;);
		ImageIO.write(thumbnailImage, &#34;jpg&#34;, fileThumbnail);
		System.out.println(&#34;          done&#34;);

		//
		// Now put the finished object into the /processed subfolder
		// Note that the filename manipulation here is not meant to be
		// production-ready and robust! It will break if files without extensions
		// are uploaded!
		//
		String fileName = key.substring( key.lastIndexOf(&#39;/&#39;) + 1, key.length() );
		String fileNameWithoutExtn = fileName.substring(0, fileName.lastIndexOf(&#39;.&#39;));
		System.out.println(&#34;     Pushing output file to processed folder...&#34;);
		s3.putObject(bucketName, &#34;processed/&#34; + fileNameWithoutExtn + &#34;.thumb.jpg&#34;, fileThumbnail);
		System.out.println(&#34;          done&#34;);
	}
	catch(Exception e)
	{
		System.out.println(String.format(
				&#34;Error processing JPEG image from stream for %s/%s&#34;, bucketName, key));
		System.out.println(e.getMessage());
	}
	finally
	{
		System.out.println(&#34;Ended resize&#34;);
	}
}

private void handleAllOtherContentTypes(String bucketName, String key) {

	System.out.println(String.format(
			&#34;%s/%s is an unsupported file type. It will be deleted.&#34;, bucketName, key));

	s3.deleteObject(bucketName, key);
	System.out.println(&#34;     Done!&#34;);
}
</code></pre><p><img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-002.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function">
3. Thêm đoạn code sau vào phần import ở đầu file <strong>LambdaFunctionHandler.java</strong> và lưu lại</p><pre tabindex=0><code>import java.awt.AlphaComposite;
import java.awt.Graphics2D;
import java.awt.RenderingHints;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.InputStream;
import javax.imageio.ImageIO;
</code></pre><p><img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-003.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></p><section class="attachments orange"><label><i class="fas fa-paperclip" aria-hidden=true></i>
LambdaFunctionHandler file</label><div class=attachments-files><li><a href=https://hotloncon1.github.io/aws-lab000052/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/_index.vi.files/LambdaFunctionHandler.java>LambdaFunctionHandler.java</a>
(5 KB)</li><div></section><ol start=4><li>Nếu gặp khó khăn, bạn có thể tham khảo file <strong>LambdaFunctionHandler.java</strong> mẫu ở trên.</li><li>Trong <strong>Command Prompt</strong>, chuyển đường dẫn đến project <strong>TestLambda</strong></li></ol><ul><li>Chạy lệnh dưới đây để build project</li></ul><pre tabindex=0><code>mvn package
</code></pre><p><img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-004.png?featherlight=false&width=60pc" alt="Deploy ImageManager Lambda Function"></p><ul><li>Kết quả trả về một tập tin có tên <strong>s3handler-1.0.0.jar</strong> trong thư mục <strong>target</strong> của project <strong>TestLambda</strong></li></ul><ol start=6><li>Truy cập <a href=https://console.aws.amazon.com/lambda><strong>AWS Lambda Console</strong></a></li></ol><ul><li>Click <strong>Functions</strong>.</li><li>Nhập <code>TestLambda</code> vào ô tìm kiếm và nhấn <strong>Enter</strong>.</li><li>Click <strong>TestLambda</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-005.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li></ul><ol start=7><li>Để cung cấp function package, trong phần <strong>Code soure</strong></li></ol><ul><li>Click <strong>Upload from</strong></li><li>Click <strong>.zip or .jar file</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-006.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li></ul><ol start=8><li>Click <strong>Upload</strong>, Chọn file <strong>s3handler-1.0.0.jar</strong> trong thư mục <strong>target</strong> của project <strong>TestLambda</strong></li></ol><ul><li>Click <strong>Save</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-007.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li></ul><ol start=9><li>Sẽ mất một chút thời gian để tải lên
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-008.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Truy cập <a href=https://s3.console.aws.amazon.com/s3/><strong>AWS S3 Console</strong></a></li></ol><ul><li>Nhập <code>idevelop-imagemanager</code> vào ô tìm kiếm</li><li>Click S3 bucket có tên bắt đầu bằng <strong>idevelop-imagemanager</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-009.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li></ul><ol start=11><li>Click thư mục <strong>uploads/</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-010.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Click <strong>Upload</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-011.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Click <strong>Add files</strong></li></ol><ul><li>Chọn file <strong>Puppy.jpg</strong> chúng ta đã tải về</li><li>Click <strong>Upload</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-012.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li></ul><ol start=14><li>Click <strong>Close</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-013.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Click <strong>idevelop-imagemanager-</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-014.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Click vào thư mục <strong>processed</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-015.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Chúng ta đã tải ảnh <strong>Puppy.jpg</strong> lên thư mục <strong>uploads</strong>. Chúng ta sẽ thấy có một hình ảnh thu nhỏ được tạo và lưu trữ tại thư mục <strong>processed/</strong>. Thư mục <strong>processed/</strong> sẽ được tạo tự động bởi hàm Lambda khi nó tạo các hình ảnh thu nhỏ.
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-016.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Truy cập <a href=https://console.aws.amazon.com/lambda><strong>AWS Lambda Console</strong></a></li></ol><ul><li>Click <strong>Functions</strong>.</li><li>Nhập <code>TestLambda</code> vào ô tìm kiếm và nhấn <strong>Enter</strong>.</li><li>Click <strong>TestLambda</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-017.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li></ul><ol start=19><li>Click <strong>Monitor</strong></li></ol><ul><li>Click <strong>View logs in CloudWatch</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-018.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li></ul><ol start=20><li>Click <strong>Log stream</strong> đầu tiên trong bảng <strong>Log streams</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-019.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Chúng ta hãy xem quá trình diễn ra như thế nào trong <strong>CloudWatch logs</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-020.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Tải lên một tập tin bất kỳ không phải hình ảnh vào thư mục <strong>uploads/</strong> (làm tương tự bước 10, 11, 12 và 13)</li></ol><ul><li>Click <strong>Close</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-021.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li></ul><ol start=23><li>Ta sẽ thấy rằng tệp tin <strong>Module1.template.yaml</strong> vừa tải lên đã bị xóa<div class="notices note"><p>Tệp tin <strong>Module3.template.yaml</strong> chúng ta đã tải lên trước khi cập nhật lại hàm <strong>Lambda</strong> nên nó không bị xóa</p></div><img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-022.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Làm tương tự bước 18, 19, 20 và 21 để xem quá trình thực hiện như thế nào trong <strong>CloudWatch log</strong>.
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-023.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Truy cập <a href=https://s3.console.aws.amazon.com/s3/><strong>AWS S3 Console</strong></a></li></ol><ul><li>Nhập <code>idevelop-imagemanager</code> vào ô tìm kiếm</li><li>Click S3 bucket có tên bắt đầu bằng <strong>idevelop-imagemanager</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-024.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li></ul><ol start=26><li>Click thư mục <strong>processed/</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-025.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Click tệp tin <strong>Puppy.thumb.jpg</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-026.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Click link trong mục <strong>Object URL</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-027.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Chúng ta sẽ nhận được thông báo <strong>Access Denied</strong> vì S3 bucket policy chưa cho phép người dùng ẩn danh có thể có truyền đọc các tập tin trong bucket.
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-028.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Click <strong>idevelop-imagemanager</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-029.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Chọn thư mục <strong>processed/</strong></li></ol><ul><li>Click <strong>Actions</strong></li><li>Click <strong>Make public using ACL</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-030.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li></ul><ol start=32><li>Click <strong>Make public</strong>
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-031.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li><li>Truy cập lại vào tệp tin. Bây giờ ta đã có thể xem được nội dung của tập tin.
<img src="https://hotloncon1.github.io/aws-lab000052/images/4-extending-serverless-microservices/4.1-deploy-imagemanager-lambda/deploy-imagemanager-lambda-032.png?featherlight=false&width=90pc" alt="Deploy ImageManager Lambda Function"></li></ol><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=https://hotloncon1.github.io/aws-lab000052/vi/4-extending-serverless-microservices/ title="Mở rộng Serverless Microservices"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=https://hotloncon1.github.io/aws-lab000052/vi/4-extending-serverless-microservices/4.2-automating-your-microservice/ title="Tự động hóa Serverless Microservice" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=https://hotloncon1.github.io/aws-lab000052/js/clipboard.min.js?1660055407></script>
<script src=https://hotloncon1.github.io/aws-lab000052/js/perfect-scrollbar.min.js?1660055407></script>
<script src=https://hotloncon1.github.io/aws-lab000052/js/perfect-scrollbar.jquery.min.js?1660055407></script>
<script src=https://hotloncon1.github.io/aws-lab000052/js/jquery.sticky.js?1660055407></script>
<script src=https://hotloncon1.github.io/aws-lab000052/js/featherlight.min.js?1660055407></script>
<script src=https://hotloncon1.github.io/aws-lab000052/js/highlight.pack.js?1660055407></script>
<script>hljs.initHighlightingOnLoad()</script><script src=https://hotloncon1.github.io/aws-lab000052/js/modernizr.custom-3.6.0.js?1660055407></script>
<script src=https://hotloncon1.github.io/aws-lab000052/js/learn.js?1660055407></script>
<script src=https://hotloncon1.github.io/aws-lab000052/js/hugo-learn.js?1660055407></script>
<link href=https://hotloncon1.github.io/aws-lab000052/mermaid/mermaid.css?1660055407 rel=stylesheet><script src=https://hotloncon1.github.io/aws-lab000052/mermaid/mermaid.js?1660055407></script>
<script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>